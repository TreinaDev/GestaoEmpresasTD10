<div class="card mt-2">
  <div class="card-body">
    <h2 class="card-title"> <%= Department.human_attribute_name('name') %>: <%=  @department.name %></h2>
    <p class="card-text"><%= Department.human_attribute_name('description') %>: <%= @department.description %></p>
    <p class="card-text"> <%= Department.human_attribute_name('code') %>: <%= @department.code %></p>
    <p class="card-text"><%= Department.human_attribute_name('company') %>: <%= @department.company.brand_name %></p>
    <br>
    <%= link_to t('.edit'), edit_company_department_path(@department.company_id, @department.id), id: 'btn_edit', class: (@department.name == 'Departamento de RH' ? 'btn btn-primary disabled' : 'btn btn-warning text-white bold') if @department.present? do%>
    <% end %>
    <%= link_to t('.new_employee'), new_company_department_employee_profile_path(company_id: @department.company_id, department_id: @department.id), id: 'btn_edit', class:'btn btn-primary'%>
    <%= link_to t('.new_position'), new_company_department_position_path(company_id: @department.company_id, department_id: @department.id), id: 'btn_edit', class:'btn btn-primary'%>
    <%= link_to t('.go_back'), company_departments_path(company_id: @department.company_id), id: 'btn_edit', class:'btn btn-primary'%>
  </div>
</div>

<% if @department.employee_profiles.any? %>
  <table class="table table-striped table-bordered rounded mt-2">
    <thead class="text-center">
      <tr>
        <th scope="col">Nome</th>
        <th scope="col">CPF</th>
        <th scope="col">Email</th>
        <th scope="col">Cargo</th>
        <th scope="col">Ações</th>
      </tr>
    <thead>
    <tbody>
      <% @department.employee_profiles.each do |employee| %>
        <tr>
          <td class="align-baseline"><%= employee.name %></td>
          <td class="align-baseline"><%= format_cpf(employee.cpf) %></td>
          <td class="align-baseline"><%= employee.email %></td>
          <td class="align-baseline"><%= employee.position.name %></td>
          <td class="d-flex justify-content-around">
            <%= button_to create_card_company_department_employee_profiles_path(company_id: @department.company_id, department_id: @department.id, card: { cpf: employee.cpf, company_card_type_id: employee.position.card_type_id }),
              method: :post, id: "delete#{employee.id}", class: 'btn btn-primary d-inline' do %>
              Solicitar Cartão
              <i class="bi bi-credit-card"></i>
            <% end %>

            <%= link_to company_department_employee_profile_path(
              company_id: @department.company.id,
              department_id: @department.id,
              employee_id: employee.id
            ),
            class: 'btn btn-primary d-inline', method: :get do %>
              Ver funcionário
              <i class="bi bi-eye"></i>
            <% end %>

          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
<% else %>
  <h3 class="mt-3">Não há funcionários neste departamento até o momento.</h3>
<% end %>


